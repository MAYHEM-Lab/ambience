add_library(microecc uECC.c)
target_include_directories(microecc PUBLIC .)
target_link_libraries(microecc PUBLIC tos_core)
target_compile_options(microecc PUBLIC "-fomit-frame-pointer")
target_compile_definitions(microecc PUBLIC uECC_OPTIMIZATION_LEVEL=3)

if (BUILD_TESTS)
add_executable(microecc_test microecc_test.cpp)
target_link_libraries(microecc_test PUBLIC tests_main microecc)
add_test(microecc_test microecc_test)
endif()

add_library(microecc_bench microecc_bench.cpp)
target_link_libraries(microecc_bench PUBLIC microecc ubench emsha)
add_benchmark(microecc_bench)