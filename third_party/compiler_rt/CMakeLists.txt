if (NOT ${TOS_ARCH} MATCHES arm OR NOT ${TOS_ARCH} MATCHES aarch64)
    return()
endif()

project(tos C CXX ASM)

set(COMPILER_RT_BUILD_BUILTINS ON)
set(COMPILER_RT_BAREMETAL_BUILD ON)
set(COMPILER_RT_DEFAULT_TARGET_ONLY ON)

set(COMPILER_RT_BUILD_SANITIZERS OFF)
set(COMPILER_RT_BUILD_XRAY OFF)
set(COMPILER_RT_BUILD_LIBFUZZER OFF)
set(COMPILER_RT_BUILD_PROFILE OFF)
set(COMPILER_RT_INCLUDE_TESTS OFF)

set(COMPILER_RT_OS_DIR "baremetal")

set(CMAKE_C_STANDARD_LIBRARIES picolibc)
set(CMAKE_CXX_STANDARD_LIBRARIES picolibc)

link_libraries(picolibc)
add_subdirectory(src)