if (NOT ${TOS_ARCH} MATCHES arm AND
        NOT ${TOS_ARCH} MATCHES aarch64 AND
        NOT ${TOS_ARCH} MATCHES x86_64 AND
        NOT ${TOS_ARCH} MATCHES i386 AND
        NOT ${TOS_ARCH} MATCHES riscv)
    return()
endif()

set(LIBCXXABI_ENABLE_EXCEPTIONS OFF CACHE STRING "")
set(LIBCXXABI_ENABLE_ASSERTIONS OFF CACHE STRING "")
set(LIBCXXABI_ENABLE_PEDANTIC OFF CACHE STRING "")
set(LIBCXXABI_ENABLE_PIC OFF CACHE STRING "")
set(LIBCXXABI_USE_COMPILER_RT ON CACHE STRING "")
set(LIBCXXABI_ENABLE_NEW_DELETE_DEFINITIONS OFF CACHE STRING "")
set(LIBCXXABI_ENABLE_SHARED OFF CACHE STRING "")
set(LIBCXXABI_LIBCXX_PATH "${TOS_PROJECT_ROOT}/libs/toscxx")

add_subdirectory(src)

target_link_libraries(cxxabi_static PUBLIC tos::libcxx)